# Reporte de proyecto

## Estructura del proyecto

```
C:\xampp\htdocs\cityquest\screens
├── detalle
│   ├── screen.css
│   ├── screen.html
│   └── screen.js
├── principal
│   ├── screen.css
│   ├── screen.html
│   └── screen.js
├── ruta
│   ├── screen.css
│   ├── screen.html
│   └── screen.js
├── screen.css
├── screen.html
└── screen.js
```

## Código (intercalado)

# screens
**screen.css**
```css
.principal{
  background:#1e293b;
}

#lista{
  display:flex;
  flex-direction:column;
  gap:15px;
  margin-top:20px;
}

.card{
  background:#334155;
  padding:10px;
  border-radius:10px;
  cursor:pointer;
}

.card img{
  width:100%;
  border-radius:10px;
}


```
**screen.html**
```html
<div class="screen principal">
  <h1>CityQuest</h1>
  <div id="lista"></div>
  <button id="btnRuta">Ver mi ruta</button>
</div>


```
**screen.js**
```js
export async function init({root,state,navigate}){
  const lista=root.querySelector("#lista");

  const data=await fetch("api/lugares.json").then(r=>r.json());
  state.lugares=data.lugares;

  lista.innerHTML=state.lugares.map(l=>`
    <div class="card" data-id="${l.id}">
      <img src="${l.imagen}">
      <h3>${l.nombre}</h3>
      <p>${l.descripcion}</p>
    </div>
  `).join("");

  lista.addEventListener("click",e=>{
    const card=e.target.closest(".card");
    if(!card) return;
    const id=parseInt(card.dataset.id);
    state.seleccionado=state.lugares.find(l=>l.id===id);
    navigate("detalle");
  });

  root.querySelector("#btnRuta").onclick=()=>navigate("ruta");
}


```
## detalle
**screen.css**
```css
.detalle{
  background:#0f766e;
}

.detalle img{
  width:100%;
  border-radius:10px;
  margin-bottom:15px;
}


```
**screen.html**
```html
<div class="screen detalle">
  <img id="img">
  <h2 id="nombre"></h2>
  <p id="desc"></p>
  <button id="addRuta">Añadir a ruta</button>
  <button id="volver">Volver</button>
</div>


```
**screen.js**
```js
let rootRef = null;
let stateRef = null;

export function init({root, state, navigate}) {
  rootRef = root;
  stateRef = state;

  root.querySelector("#volver").onclick = () => navigate("principal");

  root.querySelector("#addRuta").onclick = () => {
    if (!stateRef.seleccionado) return;
    stateRef.ruta.push(stateRef.seleccionado);
    alert("Añadido a la ruta");
  };

  render();
}

export function onShow({ state }) {
  stateRef = state;
  render();
}

function render() {
  if (!rootRef || !stateRef || !stateRef.seleccionado) return;

  const img = rootRef.querySelector("#img");
  const nombre = rootRef.querySelector("#nombre");
  const desc = rootRef.querySelector("#desc");

  img.src = stateRef.seleccionado.imagen;
  nombre.textContent = stateRef.seleccionado.nombre;
  desc.textContent = stateRef.seleccionado.descripcion;
}


```
## principal
**screen.css**
```css
.principal{
  background:#1e293b;
}

#lista{
  display:flex;
  flex-direction:column;
  gap:15px;
  margin-top:20px;
}

.card{
  background:#334155;
  padding:10px;
  border-radius:10px;
  cursor:pointer;
}

.card img{
  width:100%;
  border-radius:10px;
}


```
**screen.html**
```html
<div class="screen principal">
  <h1>CityQuest</h1>
  <div id="lista"></div>
  <button id="btnRuta">Ver mi ruta</button>
</div>


```
**screen.js**
```js
export async function init({root,state,navigate}){
  const lista=root.querySelector("#lista");

  const data=await fetch("api/lugares.json").then(r=>r.json());
  state.lugares=data.lugares;

  lista.innerHTML=state.lugares.map(l=>`
    <div class="card" data-id="${l.id}">
      <img src="${l.imagen}">
      <h3>${l.nombre}</h3>
      <p>${l.descripcion}</p>
    </div>
  `).join("");

  lista.addEventListener("click",e=>{
    const card=e.target.closest(".card");
    if(!card) return;
    const id=parseInt(card.dataset.id);
    state.seleccionado=state.lugares.find(l=>l.id===id);
    navigate("detalle");
  });

  root.querySelector("#btnRuta").onclick=()=>navigate("ruta");
}


```
## ruta
**screen.css**
```css
.ruta{
  background:#7c2d12;
}


```
**screen.html**
```html
<div class="screen ruta">
  <h2>Mi Ruta</h2>
  <div id="listaRuta"></div>
  <button id="guardar">Guardar ruta</button>
  <button id="volver">Volver</button>
</div>


```
**screen.js**
```js
export function init({root,state,navigate}){
  const lista=root.querySelector("#listaRuta");

  root.querySelector("#volver").onclick=()=>navigate("principal");

  root.querySelector("#guardar").onclick=async()=>{
    await fetch("api/guardar_ruta.php",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({ruta:state.ruta})
    });
    alert("Ruta guardada");
  };

  root.onshow=()=>{
    lista.innerHTML=state.ruta.map(l=>`
      <div>${l.nombre}</div>
    `).join("");
  };
}


```